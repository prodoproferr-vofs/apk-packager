<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meu Gerador APK - 100% Grátis</title>
  <style>
    body { font-family: system-ui; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin: 0; padding: 20px; color: white; text-align: center; }
    h1 { font-size: 2.2em; margin: 20px 0; }
    input, button { padding: 15px; margin: 10px; width: 90%; max-width: 400px; border: none; border-radius: 12px; font-size: 16px; box-sizing: border-box; }
    input { background: rgba(255,255,255,0.9); color: #333; }
    button { background: #ff6b6b; color: white; font-weight: bold; cursor: pointer; transition: background 0.3s; }
    button:hover { background: #ff5252; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    #iconUpload { margin: 10px auto; display: block; }
    #status { margin: 20px 0; font-size: 18px; min-height: 50px; }
    .download-btn { display: inline-block; background: #4CAF50; color: white; padding: 15px 30px; text-decoration: none; border-radius: 12px; font-size: 20px; margin: 10px; }
    footer { margin-top: 50px; font-size: 14px; opacity: 0.8; }
  </style>
</head>
<body>
  <h1>Meu Gerador APK</h1>
  <p>Transforme site em app Android: URL + Nome + Ícone → APK pronto!</p>

  <input type="url" id="url" placeholder="https://seusite.com" required>
  <input type="text" id="nome" placeholder="Nome do App" required>
  <input type="file" id="iconUpload" accept="image/*" style="display: none;">
  <button onclick="document.getElementById('iconUpload').click();">Escolher Ícone (Opcional)</button>
  <p id="iconPreview"></p>

  <button onclick="gerarAPK()" id="gerarBtn">GERAR APK AGORA</button>
  <div id="status"></div>

  <footer>© 2025 - Seu gerador original. Funciona 100% grátis!</footer>

  <script>
    let selectedIcon = null;
    document.getElementById('iconUpload').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        selectedIcon = file;
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('iconPreview').innerHTML = `<img src="${e.target.result}" style="width:80px; height:80px; border-radius:50%;"> Ícone OK!`;
        };
        reader.readAsDataURL(file);
      }
    });

    async function gerarAPK() {
      const url = document.getElementById('url').value.trim();
      const nome = document.getElementById('nome').value.trim();
      const status = document.getElementById('status');
      const btn = document.getElementById('gerarBtn');

      if (!url || !nome) { status.innerHTML = '❌ Preencha URL e Nome!'; return; }
      if (!url.startsWith('http')) { status.innerHTML = '❌ URL deve ser https://'; return; }

      btn.disabled = true;
      btn.textContent = 'Gerando... ⏳';
      status.innerHTML = 'Enviando pro GitHub... Aguarde 40-60s.';

      // Dispara o workflow manual (sem token, usa dispatch simples)
      const payload = { ref: 'main', inputs: { url: url, nome: nome } };  // Ícone via base64 se quiser avançar depois
      try {
        await fetch('https://api.github.com/repos/SEU_USUARIO/meu-gerador-apk/dispatches', {
          method: 'POST',
          headers: { 'Accept': 'application/vnd.github.v3+json', 'Authorization': 'token ghp_XXXXXX' },  // Crie token free em Settings > Tokens (clique "Generate new token (classic)" > repo:write)
          body: JSON.stringify({ event_type: 'gerar-apk', client_payload: payload })
        });
      } catch (e) { status.innerHTML = 'Erro no dispatch: ' + e; btn.disabled = false; return; }

      setTimeout(() => {
        status.innerHTML = `
          <b>✅ APK Gerando!</b><br>
          Vá em <a href="https://github.com/SEU_USUARIO/meu-gerador-apk/actions" target="_blank" style="color:#fff;">Ações do GitHub</a><br>
          Clique no run mais recente → Artifacts → Baixe o APK.<br>
          <small>Compartilhe o APK via WhatsApp!</small>
        `;
        btn.disabled = false;
        btn.textContent = 'GERAR OUTRO';
      }, 5000);
    }
  </script>
</body>
    </html>
